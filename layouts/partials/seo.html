{{- $title := .Title -}}
{{- if .IsHome -}}
  {{- $title = .Site.Title -}}
{{- else -}}
  {{- $title = printf "%s - %s" .Title .Site.Title -}}
{{- end -}}

{{- $desc := .Description -}}
{{- if not $desc -}}{{- $desc = .Summary -}}{{- end -}}
{{- if not $desc -}}{{- $desc = .Site.Params.description -}}{{- end -}}
{{- $desc = $desc | plainify -}}

{{- $image := .Params.image -}}
{{- if not $image -}}{{- $image = .Site.Params.defaultImage -}}{{- end -}}
{{- if $image -}}{{- $image = absURL $image -}}{{- end -}}

{{- $published := .PublishDate -}}
{{- if not $published -}}{{- $published = .Date -}}{{- end -}}
{{- $modified := .Lastmod -}}
{{- if not $modified -}}{{- $modified = $published -}}{{- end -}}

<title>{{ $title }}</title>
<meta name="description" content="{{ $desc }}">

<link rel="canonical" href="{{ .Permalink }}">

<meta property="og:title" content="{{ $title }}">
<meta property="og:description" content="{{ $desc }}">
<meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
<meta property="og:url" content="{{ .Permalink }}">
{{- if $image }}
<meta property="og:image" content="{{ $image }}">
{{- end }}
<meta property="og:site_name" content="{{ .Site.Title }}">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ $title }}">
<meta name="twitter:description" content="{{ $desc }}">
{{- if $image }}
<meta name="twitter:image" content="{{ $image }}">
{{- end }}
{{- with .Site.Params.twitter }}
<meta name="twitter:site" content="@{{ . }}">
{{- end }}

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": {{ if .IsPage }}"BlogPosting"{{ else }}"Blog"{{ end }},
  "headline": {{ $title | jsonify }},
  "description": {{ $desc | jsonify }},
  "url": {{ .Permalink | jsonify }},
  {{- if $image }}
  "image": {{ $image | jsonify }},
  {{- end }}
  "author": { "@type": "Person", "name": {{ .Site.Params.author | jsonify }} },
  "datePublished": {{ $published | time.Format "2006-01-02T15:04:05Z07:00" | jsonify }},
  "dateModified": {{ $modified | time.Format "2006-01-02T15:04:05Z07:00" | jsonify }}
}
</script>
